---
# ================================
# Variables
# ================================

- include: variables.yml
  tags: "always"

# ================================
# Common
# ================================

- include: "common/swap.yml"
  tags: ["common", "common-swap"]

- include: "common/upgrade.yml"
  tags: ["common", "common-upgrade"]

- include: common/install.yml
  tags: ["common", "common-install"]

- include: common/admin.yml
  tags: ["common", "common-admin"]

- include: common/filesystem.yml
  tags: ["common", "common-filesystem"]

- include: common/config.yml
  tags: ["common", "common-config"]

- include: common/firewall.yml
  tags: ["common", "common-firewall"]

# ================================
# Docker
# ================================

- include: docker/docker.yml
  tags: ["docker", "docker-install"]
  when: "'docker' not in ansible_facts.packages"

- include: docker/services.yml
  tags: ["docker", "docker-services"]

- include: docker/mysql.yml
  tags: ["docker", "docker-mysql"]

# ================================
# OpenLitespeed
# ================================

- include: olsws/olsws.yml
  tags: "olsws"

# ================================
# Tools
# ================================

- include: tools/php.yml
  tags: "php"

- include: tools/composer.yml
  tags: "composer"

- include: tools/wpcli.yml
  tags: "wpcli"

- include: tools/pma.yml
  tags: "pma"

- include: tools/cockpit.yml
  tags: "cockpit"

- include: tools/health.yml
  tags: "health"

- include: tools/fail2ban.yml
  tags: "fail2ban"

# ================================
# Users
# ================================

- include: users/users.yml
  tags: "users"

# ================================
# Tests
# ================================

- include: tests/tests.yml
  tags: ["never", "test"]
